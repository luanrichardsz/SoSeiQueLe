<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Registre-se</title>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

        <style>
            body { background-color: #f1f1f7; }
            .register-card { background: #fff; border-radius: 15px; padding: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.08); overflow: hidden; }
            .left-image img { width: 100%; height: 100%; object-fit: cover; }

            @media (max-width: 991px) {
                body { padding: 20px; height: auto !important; }
                .register-card { border-radius: 12px; }
                .col-lg-6.p-3 { padding: 25px !important; }
                h5.fw-bold { font-size: 1.5rem; }
            }
            @media (max-width: 768px) {
                body { padding-top: 40px; }
                .register-card { margin-top: 30px; }
                form input, .btn-primary { height: 48px; }
            }
            @media (max-width: 576px) {
                .container { padding: 0; }
                .register-card { border-radius: 10px; }
                .col-lg-6.p-3 { padding: 20px !important; }
                h5 { font-size: 1.3rem; }
                form input, .btn-primary { height: 45px; font-size: 0.95rem; }
            }
        </style>
    </head>

    <body class="d-flex justify-content-center align-items-center" style="min-height: 100vh; padding: 50px 20px; background-color: #f1f1f7;">

        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8 register-card">

                    <div class="row g-0">
                        <div class="col-lg-6 left-image d-none d-lg-block">
                            <img src="https://images.pexels.com/photos/1370296/pexels-photo-1370296.jpeg" alt="Livro" />
                        </div>

                        <div class="col-lg-6 p-3">
                            <h5 class="fw-bold">Crie a Sua Conta</h5>
                            <p class="text-muted mb-3">Tenha um gerenciamento dos seus livros favoritos.</p>

                            <form id="formRegistro">
                                
                                <div class="row">
                                    <div class="col-6 mb-2">
                                        <label class="form-label small">Nome</label>
                                        <input type="text" id="nome" class="form-control form-control-sm" placeholder="Seu nome" required>
                                    </div>
                                    <div class="col-6 mb-2">
                                        <label class="form-label small">Sobrenome</label>
                                        <input type="text" id="sobrenome" class="form-control form-control-sm" placeholder="Sobrenome" required>
                                    </div>
                                </div>

                                <div class="mb-2">
                                    <label class="form-label small">Data de Nascimento</label>
                                    <input type="date" id="data_nascimento" class="form-control form-control-sm" required>
                                </div>

                                <div class="mb-2">
                                    <label class="form-label small">Usuário de Login</label>
                                    <input type="text" id="nome_usuario" class="form-control form-control-sm" placeholder="Ex: joao.silva" required>
                                </div>

                                <div class="mb-2">
                                    <label class="form-label small">Senha</label>
                                    <input type="password" id="senha" class="form-control form-control-sm" placeholder="********" required>
                                </div>

                                <div class="mb-3"> <label class="form-label small">Confirme sua senha</label>
                                    <input type="password" id="confirma_senha" class="form-control form-control-sm" placeholder="********" required>
                                </div>

                                <button type="submit" class="btn btn-primary w-100">Criar Conta</button>

                                <p class="text-center mt-2 mb-0 small">
                                    Já tem uma conta? 
                                    <a href="../../index.html" class="text-decoration-none fw-bold">Login</a>
                                </p>
                            </form>
                        </div>

                    </div>

                </div>
            </div>
        </div>

        <script>
            const API_URL = 'http://localhost/SoSeiQueLe/Back'; 

            document.getElementById('formRegistro').addEventListener('submit', async (e) => {
                e.preventDefault();
                const nome = document.getElementById('nome').value;
                const sobrenome = document.getElementById('sobrenome').value;
                const nascimento = document.getElementById('data_nascimento').value;
                const usuario = document.getElementById('nome_usuario').value;
                const senha = document.getElementById('senha').value;
                const confirmaSenha = document.getElementById('confirma_senha').value;

                if (senha !== confirmaSenha) {
                    alert("A senha e a confirmação não são iguais!");
                    return;
                }
                
                const dados = {
                    nome: nome,
                    sobrenome: sobrenome,
                    data_nascimento: nascimento,
                    nome_usuario: usuario,
                    senha: senha
                };

                try {
                    const response = await fetch(`${API_URL}/registro.php`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(dados)
                    });
                    
                    const resultado = await response.json();
                    alert(resultado.message);

                    if (resultado.message.includes("sucesso")) {
                        window.location.href = '../../index.html';
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    alert("Erro ao conectar com o servidor.");
                }
            });
        </script>
    </body>
</html>